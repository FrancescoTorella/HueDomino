<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel = "stylesheet" type = "text/css" href = "/profilo/profilo.css">
    <link rel = "stylesheet" type = "text/css" href = "/styles/bootstrap.css">
    <link rel = "stylesheet" type = "text/css" href = "/styles/pixeledborder.css">
    <link rel = "stylesheet" type = "text/css" href = "/styles/pixeledButtons.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <title>Il Tuo Profilo</title>
</head>
<body>
    <div class="header">
        <div class="row">
            <div class="col-12 col-xxl-1 col-md-2 col-sm-3 image-container">
                <div class="profile-image-container">
                    <img id="profileImage" class="profile-image" src="" alt="Foto del Profilo">
                </div> 
            </div>
            <div class="col-12 col-xxl-7 col-md-4 col-sm-5 profile-info">
                <div id="profileName" class="profile-name">NomedelProfilo</div>
                <div id="profileDescription" class="profile-description">Questa√®ladescrizionedelprofilo</div>
            </div>
            <div class="col-12 col-xxl-4 col-sm-4 col-md-6 buttons-container">
                <button id="mainMenuButton" class="pixel2">
                    <span id="mainMenuButtonText">Menu</span>
                    <img class="menu-icon" src="/profilo/icons/backGreen.svg" alt="Icona Menu">
                </button>
                <button id="logoutButton" class="pixel2">
                    <span id="logoutButtonText">Logout</span>
                    <img class="logout-icon" src="/profilo/icons/logout.svg" alt="Icona Logout">
                </button>
            </div>
        </div>
    </div>

    <div class="main">
        <nav class="sidebar">
            <ul>
                <li><a href="#impostazioni"><img class="menu-icon" src="/profilo/icons/settings.svg" alt="Icona Impostazioni" id="settingsIcon"> Impostazioni</a></li>
                <li><a href="#statistiche"><img class="menu-icon" src="/profilo/icons/statistics.svg" alt="Icona Statistiche" id="statisticsIcon"> Statistiche</a></li>
                <li><a href="#amici"><img class="menu-icon" src="/profilo/icons/friends.svg" alt="Icona Amici" id="friendsIcon"> Amici</a></li>
                <li><a href="#avatar"><img class="menu-icon" src="/profilo/icons/avatar.svg" alt="Icona Avatar" id="avatarIcon"> Avatar</a></li>
                <li><a href="#medaglie"><img class="menu-icon" src="/profilo/icons/medals.svg" alt="Icona Medaglie" id="medalsIcon"> Medaglie</a></li>
                <li><a href="#livelli"><img class="menu-icon" src="/profilo/icons/levels.svg" alt="Icona Livelli" id="levelsIcon"> Livelli</a></li>
            </ul>
        </nav>

        <div id="impostazioni" class="content">
            <img class="back-button" src="/profilo/icons/back.svg" alt="Icona Indietro">
            <h2 class="section-title">Impostazioni utente:</h2>
            <form id="uploadProfileImageForm"  class="settings-form" method="post" enctype="multipart/form-data">
                <label for="foto-profilo" class="profile-image-settings">
                    <!-- <div class="profile-image-settings" id="profileImageSettings"></div> -->
                    <div class="profile-image-container">
                        <img id="profileImageSettings" class="profile-image" src="" alt="Foto del Profilo">
                    </div> 
                    <div class="profile-image-overlay">
                        <span>Modifica</span>
                    </div>
                </label>
                <input type="file" id="foto-profilo" name="foto-profilo" accept="image/*" style="display: none;">
            </form>
            <form id="updateDescription" class="settings-form">
                <br>
                <label for="descrizione" class="col-form-label">Descrizione:</label><br>
                <textarea id="descrizione" name="descrizione" rows="4" cols="50" class="form-control descrizione-larghezza" maxlength="50"></textarea><br><br>
            </form>
            <form id="updateUsername" class="settings-form">
                <label for="username" class="col-form-label" >Nome utente:</label><br>
                <input type="text" id="username" name="username" autocomplete="off" class="form-control username-larghezza">
                <span id="usernameError" class="text-danger"></span><br>
                <label for="password" class="col-form-label" >Password:</label><br>
                <input type="password" id="passwordForUsername" name="password" class="form-control password-larghezza" autocomplete="off">
                <span id="passwordErrorInUpdateUsername" class="text-danger"></span><br>
                <button type="submit" id="changeUsernameButton" class="pixel2">Cambia Nome Utente</button><br><br>
            </form>
            <form id="updateEmail" class="settings-form">
                <label for="email" class="col-form-label" >Nuova Email:</label><br>
                <input type="text" id="email" name="email" class="form-control email-larghezza" autocomplete="off">
                <span id="emailError" class="text-danger"></span><br>
                <label for="password" class="col-form-label" >Password:</label><br>
                <input type="password" id="passwordForEmail" name="password" class="form-control password-larghezza" autocomplete="off">
                <span id="passwordErrorInUpdateEmail" class="text-danger"></span><br>
                <button type="submit" id="changeEmailButton" class="pixel2">Cambia Email</button><br><br>
            </form>
            <form id="updatePassword" class="settings-form">
                <label for="new-password" class="col-form-label" >Nuova Password:</label><br>
                <input type="password" id="newPassword" name="new-password" class="form-control new-password-larghezza" autocomplete="off">
                <span id="newPasswordError" class="text-danger"></span><br>
                <label for="old-password" class="col-form-label" >Vecchia Password:</label><br>
                <input type="password" id="oldPassword" name="old-password" autocomplete="off" class="form-control old-password-larghezza" autocomplete="off">
                <span id="oldPasswordError" class="text-danger"></span><br>
                <button type="submit" id="changePasswordButton" class="pixel2">Cambia Password</button><br><br>
            </form>
        </div>
        <div id="statistiche" class="content">
            <img class="back-button" src="/profilo/icons/back.svg" alt="Icona Indietro">
            <h2 class="section-title">Statistiche:</h2>
            <p class="stat-element">Livelli superati: <span class="stat-text" id="livelliSuperati">0</span></p>
            <p class="stat-element">Mondi giocati: <span class="stat-text" id="mondiGiocati">0</span></p>
            <p class="stat-element">Numero amici: <span class="stat-text" id="numeroAmici">0</span></p>
            <p class="stat-element">Medaglie vinte: <span class="stat-text" id="medaglieVinte">0</span></p>
            <p class="stat-element">Avatar sbloccati: <span class="stat-text" id="avatarSbloccati">0</span></p>
        </div>
        <div id="amici" class="content">
            <img class="back-button" src="/profilo/icons/back.svg" alt="Icona Indietro">
            <h2 class="section-title">Amici:</h2>
            <form id="addFriendForm" class="friend-form">
                <label for="friendUsername" class="col-form-label">Nome utente dell'amico che vuoi aggiungere:</label><br>
                <input type="text" id="friendUsername" name="friendUsername" autocomplete="off" class="form-control new-friend-larghezza">
                <span id="friendError" class="text-danger"></span><br>
                <button type="submit" id="addFriendButton" class="pixel2">Aggiungi Amico</button><br>
            </form>
            <table id="friendsTable">
                <tr>
                    <th>Profilo</th>
                    <th>Statistiche</th>
                    <th>Opzioni</th>
                </tr>
                <!-- Le righe per gli amici saranno aggiunte qui dal codice JS -->
            </table>
        </div>
        <div id="avatar" class="content">
            <img class="back-button" src="/profilo/icons/back.svg" alt="Icona Indietro">
            <h2 class="section-title">Avatar ottenuti:</h2>
        </div>
        <div id="medaglie" class="content">
            <img class="back-button" src="/profilo/icons/back.svg" alt="Icona Indietro">
            <h2 class="section-title">Livelli Creati:</h2>
            <h3 class="section-subtitle">I miei livelli:</h3>
            <div class="container p-0 m-1">
                <div id="myLevelsGrid" class="row m-3">
                
                </div>
            </div>
            <h3 class="section-subtitle">Livelli dei miei amici:</h3>
            <div class="container p-0 m-1">
                <div id="friendsLevelsGrid" class="row m-3">
                
                </div>
            </div>
        </div>
        <div id="livelli" class="content">
            <img class="back-button" src="/profilo/icons/back.svg" alt="Icona Indietro">
            <h2 class="section-title">Livelli Completati:</h2>
            <div class="container p-0 m-1">
                <div id="levelsGrid" class="row m-3">
                
                </div>

            </div>
            
        </div>
    </div>
    

    
    <script src="/profilo/layout.js"></script>
    <script type="module" src="/profilo/loadData.js"></script>
    <script type="module" src="/profilo/requestsHandler.js"></script>
    


    <div class="alert-div container-sm text-center col-lg-6 col-12 p-0" id="alertDiv">
        <div class="row alert-message-row">
            <div class="col-12 alert-message-container" >
                <span id="alertMessage" class="alert-message"></span>
            </div>
        </div>
        <div class="row alert-button-row">
            <div class="col-6 alert-button-container">
                <button id="cancelButton" class="pixel2">Annulla</button>   
            </div>
            <div class="col-6 alert-button-container">
                <button id="confirmButton" class="pixel2">Conferma</button>
            </div>
        </div>
    </div>

    <div class="overlay" id="overlay"></div>
    <script>
        $('#logoutButton').click(function() {
            $('#alertDiv, #overlay').show();
            $('#alertMessage').text('Sei sicuro di voler effettuare il logout?');
            $('#confirmButton').attr('data-action', 'logout');
            
        });

        $(document).on('click','#removeFriendButton', function() {
            $('#alertDiv, #overlay').show();
            $('#alertMessage').text('Sei sicuro di voler rimuovere ' + $(this).attr('data-usernameamico')+' dagli amici');
            $('#confirmButton').attr('data-action', 'removeFriend'+ $(this).attr('data-idamico'));
        });

        $(document).on('click','#playCreatedLevelButton', function() {
            var userId = $(this).attr('data-idAmico');
            var level = $(this).attr('data-level');

            // Imposta i cookie
            document.cookie = "creatorId=" + userId + "; max-age=1"; // Durata di 1 secondo
            document.cookie = "level=" + level + "; max-age=1"; // Durata di 1 secondo

            // Rimuovi i cookie dopo 500 millisecondi
            setTimeout(function() {
                document.cookie = "creatorId=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                document.cookie = "level=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
            }, 500);

            window.location.href = '/creator/level-play';
            
        });


        $('#mainMenuButton').click(function() {
            window.location.href = '/';
        });

        $('#alertDiv, #overlay').hide();

        $('#overlay').click(function() {
            $('#alertDiv, #overlay').hide();
        });
        $('#cancelButton').click(function() {
            $('#alertDiv, #overlay').hide();
        });
    </script>
</body>
</html>
    

</body>
</html>